# bricking

一个通用的微模块构建和开发工具，基于 rollup 进行封装。

核心能力在于将业务模块独立构建成 systemjs 模块代码，模块内资源使用相对路径进行引用，对部署环境无依赖(同时支持离线应用)。

## 一、特点

- 运行时的模块复用
- 模块自身使用相对路径管理相关静态资源，无部署环境依赖
- 第三方依赖可独立构建部署，减少主应用构建时间
- 支持离线方案
- 支持使用 css module
- 支持 less (后续开发 sass、stylus 等)
- 开发环境热重载 (暂不支持模块热替换)

## 二、使用文档

[接入文档](https://confluence.myscrm.cn/pages/viewpage.action?pageId=23664798)

## 三、为什么要进行微模块化改造

传统的SPA项目的代码结构一般可以简单地分为三层，通用层、应用层、业务模块层。

- 通用层：一般是一些第三方库、框架以及自定义的一些通用方法和组件
- 应用层：应用的入口。通常是一些路由的定义、全局状态的配置等。
- 业务层：具体的业务逻辑代码，通常我们需要根据实际的功能将他们拆分成各个业务模块。

这三者的稳定性关系：通用层 > 应用层 > 业务层。

### 3.1 传统SPA项目存在的问题

1. 随着业务拓展，代码体积激增，可维护性变差
2. 并行开发时容易造成冲突和阻塞。
3. 任何业务需求的改动都需要构建和发布整个项目，不符合开放闭合原则，对时间和资源都是很大的浪费
4. 开放性不足业务模块与整个项目代码耦合在一起，无法复用。例如：如果某个租住只想接入某个模块的功能，那么他必须接入在运行时接入整个项目的代码资源。

### 3.2 微模块化改造如何解决这些问题

微模块改造的核心就是两个词：**拆分**、**组合**。

将频繁变动的业务层**拆分**出来，进行独立构建和部署。然后在运行时将这些模块进行**组合**。

对于某个业务模块而言，如果多个系统的**通用层**时兼容的，那么该业务模块就可以在运行时被共用。举个例子 🌰 ：如果模块**M**仅仅依赖与**A 、B 、C** 这个三个通用库， X项目的通用层包括 **A 、B 、C、D**，Y项目的通用层包括**A、B、C、E**，那么 模块 **M** 可以同时这两个项目使用(理论上可行)。

### 3.3 更多

微模块方案不仅仅适用于业务模块的分离。它的本质是可复用的运行时模块，你可以用它来构建任何东西。

## 为什么不是微应用

微应用解决的是多应用的聚合问题，微模块解决的是复杂单应用的拆解问题。

